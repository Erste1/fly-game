<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"/>
<title>NEON DASH PRO</title>

<style>
:root{
 --g:#2ecc71;
 --y:#f1c40f;
 --b:#3498db;
 --r:#e74c3c;
}

body{
 margin:0;
 overflow:hidden;
 font-family:Arial Black;
 background:#000;
}

/* HUD */
#hud{
 position:fixed;
 top:15px;
 width:100%;
 display:flex;
 justify-content:space-between;
 padding:0 20px;
 color:#fff;
 font-size:20px;
 z-index:5;
 text-shadow:0 0 6px #000;
}

/* MODAL */
.modal{
 position:fixed;
 inset:0;
 background:rgba(0,0,0,.9);
 display:flex;
 align-items:center;
 justify-content:center;
}

.card{
 width:92%;
 max-width:380px;
 background:#111;
 padding:25px;
 border-radius:22px;
 border:3px solid #222;
 text-align:center;
 color:#fff;
}

.btn{
 width:100%;
 padding:14px;
 margin:6px 0;
 border:none;
 border-radius:12px;
 font-weight:bold;
 font-size:18px;
 background:var(--g);
 color:#fff;
}

.btn.blue{background:var(--b)}
.btn.red{background:var(--r)}

.grid{
 display:grid;
 grid-template-columns:repeat(2,1fr);
 gap:10px;
 max-height:260px;
 overflow:auto;
}

.item{
 padding:12px;
 border-radius:12px;
 background:#222;
 border:3px solid #333;
 font-size:13px;
 cursor:pointer;
}

.item.active{border-color:var(--g)}
</style>
</head>

<body>

<canvas id="c"></canvas>

<div id="hud">
 <div>SCORE: <span id="score">0</span></div>
 <div style="color:var(--y)">ðŸ’° <span id="coins">0</span></div>
</div>

<!-- MENU -->
<div id="menu" class="modal">
 <div class="card">
  <h2>NEON DASH PRO</h2>
  <button class="btn" onclick="Game.start()">PLAY</button>
  <button class="btn blue" onclick="Shop.open()">SHOP</button>
  <div style="margin-top:10px;color:#888">BEST: <span id="best">0</span></div>
 </div>
</div>

<!-- SHOP -->
<div id="shop" class="modal" style="display:none">
 <div class="card">
  <h3>SHOP</h3>
  <div id="items" class="grid"></div>
  <button class="btn red" onclick="Shop.close()">EXIT</button>
 </div>
</div>

<script>
/* ================= CANVAS ================= */
const canvas=c;
const ctx=canvas.getContext("2d");

function resize(){
 canvas.width=innerWidth;
 canvas.height=innerHeight;
}
resize();
addEventListener("resize",resize);

/* ================= SAVE ================= */
const S={
 load:(k,d)=>JSON.parse(localStorage.getItem(k))??d,
 set:(k,v)=>localStorage.setItem(k,JSON.stringify(v))
};

/* ================= STATE ================= */
const State={
 coins:S.load("coins",0),
 best:S.load("best",0),
 owned:S.load("owned",[0]),
 active:0
};

/* ================= SHOP DB ================= */
const DB=[
 {color:"#2ecc71",p:0},
 {color:"#e74c3c",p:20},
 {color:"#f1c40f",p:40},
 {color:"#3498db",p:60},
 {color:"#9b59b6",p:80},
 {color:"#ffffff",p:100}
];

/* ================= SHOP ================= */
const Shop={
 open(){shop.style.display="flex";this.render()},
 close(){shop.style.display="none"},
 render(){
  items.innerHTML="";
  DB.forEach((it,i)=>{
   const d=document.createElement("div");
   d.className="item"+(State.active===i?" active":"");
   d.style.background=it.color;
   d.innerHTML=State.owned.includes(i)?"USE":"ðŸ’° "+it.p;
   d.onclick=()=>this.buy(i);
   items.appendChild(d);
  });
 },
 buy(i){
  const it=DB[i];
  if(State.owned.includes(i)){
   State.active=i;
  }else if(State.coins>=it.p){
   State.coins-=it.p;
   State.owned.push(i);
   State.active=i;
   S.set("owned",State.owned);
  }
  S.set("coins",State.coins);
  this.render();
 }
};

/* ================= PLAYER ================= */
const Player={
 x:80,y:0,vy:0,rot:0,

 reset(){
  this.y=Game.ground-40;
  this.vy=0;
  this.rot=0;
 },

 jump(){
  if(this.y>=Game.ground-41) this.vy=-15;
 },

 update(){
  this.vy+=0.85;
  this.y+=this.vy;

  if(this.y>=Game.ground-40){
   this.y=Game.ground-40;
   this.vy=0;

   /* ðŸ”¥ Ð¤Ð˜ÐšÐ¡: Ð²ÑÑ‚Ð°Ñ‘Ñ‚ Ñ€Ð¾Ð²Ð½Ð¾ */
   this.rot=Math.round(this.rot/90)*90;
  }else{
   this.rot+=8;
  }
 },

 draw(){
  ctx.save();
  ctx.translate(this.x+20,this.y+20);
  ctx.rotate(this.rot*Math.PI/180);

  ctx.fillStyle=DB[State.active].color;
  ctx.shadowColor=DB[State.active].color;
  ctx.shadowBlur=18;

  ctx.fillRect(-20,-20,40,40);
  ctx.restore();
 }
};

/* ================= GAME ================= */
const Game={
 active:false,
 ground:0,
 objs:[],
 score:0,
 speed:8,
 frame:0,

 start(){
  menu.style.display="none";
  this.active=true;
  this.objs=[];
  this.score=0;
  this.speed=8;
  Player.reset();
 },

 over(){
  this.active=false;
  if(this.score>State.best){
   State.best=this.score;
   S.set("best",State.best);
  }
  menu.style.display="flex";
 },

 update(){
  if(!this.active) return;

  this.frame++;
  Player.update();

  if(this.frame%90===0) this.objs.push({x:canvas.width,type:"s"});
  if(this.frame%130===0) this.objs.push({x:canvas.width,y:this.ground-90,type:"c",r:0});

  for(let i=this.objs.length-1;i>=0;i--){
   let o=this.objs[i];
   o.x-=this.speed;

   if(o.type==="s"){
    if(Math.abs(o.x-Player.x)<30 && Player.y>this.ground-60) this.over();
   }else{
    o.r+=.15;
    if(Math.hypot(o.x-Player.x,o.y-Player.y)<28){
     State.coins++;
     S.set("coins",State.coins);
     this.objs.splice(i,1);
    }
   }

   if(o.x<-60){
    if(o.type==="s") this.score++;
    this.objs.splice(i,1);
   }
  }
 },

 drawBG(){
  const g=ctx.createLinearGradient(0,0,0,canvas.height);
  g.addColorStop(0,"#001b2f");
  g.addColorStop(1,"#000");
  ctx.fillStyle=g;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  /* ÑÐµÑ‚ÐºÐ° */
  ctx.strokeStyle="rgba(255,255,255,.05)";
  for(let i=0;i<canvas.width;i+=40){
   ctx.beginPath();ctx.moveTo(i,0);ctx.lineTo(i,canvas.height);ctx.stroke();
  }
 },

 draw(){
  this.ground=canvas.height-120;

  this.drawBG();

  ctx.fillStyle="#111";
  ctx.fillRect(0,this.ground,canvas.width,200);

  this.objs.forEach(o=>{
   if(o.type==="s"){
    ctx.fillStyle="#222";
    ctx.fillRect(o.x,this.ground-40,40,40);
   }else{
    ctx.save();
    ctx.translate(o.x,o.y);
    ctx.rotate(o.r);
    ctx.fillStyle="#f1c40f";
    ctx.beginPath();
    ctx.arc(0,0,12,0,Math.PI*2);
    ctx.fill();
    ctx.restore();
   }
  });

  Player.draw();
 }
};

/* ================= LOOP ================= */
function loop(){
 Game.update();
 Game.draw();

 score.textContent=Game.score;
 coins.textContent=State.coins;
 best.textContent=State.best;

 requestAnimationFrame(loop);
}
loop();

addEventListener("mousedown",()=>Player.jump());
addEventListener("touchstart",(e)=>{e.preventDefault();Player.jump();},{passive:false});
</script>
</body>
</html>
